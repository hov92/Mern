{"ast":null,"code":"import _toConsumableArray from\"/Users/dwaynehovington/Desktop/Mern/mern/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/dwaynehovington/Desktop/Mern/mern/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import socketIOClient from'socket.io-client';var ENDPOINT=window.location.host.indexOf('localhost')>=0?'http://127.0.0.1:5000':window.location.host;export default function ChatBox(props){var userInfo=props.userInfo;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),socket=_useState2[0],setSocket=_useState2[1];var uiMessagesRef=useRef(null);var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isOpen=_useState4[0],setIsOpen=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),messageBody=_useState6[0],setMessageBody=_useState6[1];var _useState7=useState([{name:'Admin',body:'Hello there, Please ask your question.'}]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];useEffect(function(){if(uiMessagesRef.current){uiMessagesRef.current.scrollBy({top:uiMessagesRef.current.clientHeight,left:0,behavior:'smooth'});}if(socket){socket.emit('onLogin',{_id:userInfo._id,name:userInfo.name,isAdmin:userInfo.isAdmin});socket.on('message',function(data){setMessages([].concat(_toConsumableArray(messages),[{body:data.body,name:data.name}]));});}},[messages,isOpen,socket,userInfo._id,userInfo.isAdmin,userInfo.name]);var supportHandler=function supportHandler(){setIsOpen(true);console.log(ENDPOINT);var sk=socketIOClient(ENDPOINT);setSocket(sk);};var submitHandler=function submitHandler(e){e.preventDefault();if(!messageBody.trim()){alert('Error. Please type message.');}else{setMessages([].concat(_toConsumableArray(messages),[{body:messageBody,name:userInfo.name}]));setMessageBody('');setTimeout(function(){socket.emit('onMessage',{body:messageBody,name:userInfo.name,isAdmin:userInfo.isAdmin,_id:userInfo._id});},1000);}};var closeHandler=function closeHandler(){setIsOpen(false);};return/*#__PURE__*/React.createElement(\"div\",{className:\"chatbox\"},!isOpen?/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:supportHandler},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-support\"})):/*#__PURE__*/React.createElement(\"div\",{className:\"card card-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Support \"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:closeHandler},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-close\"}))),/*#__PURE__*/React.createElement(\"ul\",{ref:uiMessagesRef},messages.map(function(msg,index){return/*#__PURE__*/React.createElement(\"li\",{key:index},/*#__PURE__*/React.createElement(\"strong\",null,\"\".concat(msg.name,\": \")),\" \",msg.body);})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:submitHandler,className:\"row\"},/*#__PURE__*/React.createElement(\"input\",{value:messageBody,onChange:function onChange(e){return setMessageBody(e.target.value);},type:\"text\",placeholder:\"type message\"}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"Send\")))));}","map":{"version":3,"sources":["/Users/dwaynehovington/Desktop/Mern/mern/client/src/components/Chatbox.js"],"names":["React","useEffect","useRef","useState","socketIOClient","ENDPOINT","window","location","host","indexOf","ChatBox","props","userInfo","socket","setSocket","uiMessagesRef","isOpen","setIsOpen","messageBody","setMessageBody","name","body","messages","setMessages","current","scrollBy","top","clientHeight","left","behavior","emit","_id","isAdmin","on","data","supportHandler","console","log","sk","submitHandler","e","preventDefault","trim","alert","setTimeout","closeHandler","map","msg","index","target","value"],"mappings":"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","sourcesContent":["\nimport React, { useEffect, useRef, useState } from 'react';\nimport socketIOClient from 'socket.io-client';\n\nconst ENDPOINT =\n    window.location.host.indexOf('localhost') >= 0\n        ? 'http://127.0.0.1:5000'\n        : window.location.host;\n\nexport default function ChatBox(props) {\n    const { userInfo } = props;\n    const [socket, setSocket] = useState(null);\n    const uiMessagesRef = useRef(null);\n    const [isOpen, setIsOpen] = useState(false);\n    const [messageBody, setMessageBody] = useState('');\n    const [messages, setMessages] = useState([\n        { name: 'Admin', body: 'Hello there, Please ask your question.' },\n    ]);\n\n    useEffect(() => {\n        if (uiMessagesRef.current) {\n            uiMessagesRef.current.scrollBy({\n                top: uiMessagesRef.current.clientHeight,\n                left: 0,\n                behavior: 'smooth',\n            });\n        }\n        if (socket) {\n            socket.emit('onLogin', {\n                _id: userInfo._id,\n                name: userInfo.name,\n                isAdmin: userInfo.isAdmin,\n            });\n            socket.on('message', (data) => {\n                setMessages([...messages, { body: data.body, name: data.name }]);\n            });\n        }\n    }, [messages, isOpen, socket,userInfo._id, userInfo.isAdmin, userInfo.name]);\n\n    const supportHandler = () => {\n        setIsOpen(true);\n        console.log(ENDPOINT);\n        const sk = socketIOClient(ENDPOINT);\n        setSocket(sk);\n    };\n    const submitHandler = (e) => {\n        e.preventDefault();\n        if (!messageBody.trim()) {\n            alert('Error. Please type message.');\n        } else {\n            setMessages([...messages, { body: messageBody, name: userInfo.name }]);\n            setMessageBody('');\n            setTimeout(() => {\n                socket.emit('onMessage', {\n                    body: messageBody,\n                    name: userInfo.name,\n                    isAdmin: userInfo.isAdmin,\n                    _id: userInfo._id,\n                });\n            }, 1000);\n        }\n    };\n    const closeHandler = () => {\n        setIsOpen(false);\n    };\n    return (\n        <div className=\"chatbox\">\n            {!isOpen ? (\n                <button type=\"button\" onClick={supportHandler}>\n                    <i className=\"fa fa-support\" />\n                </button>\n            ) : (\n                    <div className=\"card card-body\">\n                        <div className=\"row\">\n                            <strong>Support </strong>\n                            <button type=\"button\" onClick={closeHandler}>\n                                <i className=\"fa fa-close\" />\n                            </button>\n                        </div>\n                        <ul ref={uiMessagesRef}>\n                            {messages.map((msg, index) => (\n                                <li key={index}>\n                                    <strong>{`${msg.name}: `}</strong> {msg.body}\n                                </li>\n                            ))}\n                        </ul>\n                        <div>\n                            <form onSubmit={submitHandler} className=\"row\">\n                                <input\n                                    value={messageBody}\n                                    onChange={(e) => setMessageBody(e.target.value)}\n                                    type=\"text\"\n                                    placeholder=\"type message\"\n                                />\n                                <button type=\"submit\">Send</button>\n                            </form>\n                        </div>\n                    </div>\n                )}\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}